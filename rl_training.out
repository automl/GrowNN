Config {'hydra': {'run': {'dir': './tmp/${now:%Y-%m-%d}/${now:%H-%M-%S}'}, 
'sweep': {'dir': './tmp/${now:%Y-%m-%d}/${now:%H-%M-%S}', 'subdir': 
'${hydra.job.num}'}, 'launcher': {'submitit_folder': 
'${hydra.sweep.dir}/.submitit/%j', 'timeout_min': 600, 'cpus_per_task': 16, 
'gpus_per_node': None, 'tasks_per_node': 1, 'mem_gb': 64, 'nodes': 1, 'name': 
'${hydra.job.name}', 'stderr_to_stdout': False, '_target_': 
'hydra_plugins.hydra_submitit_launcher.submitit_launcher.SlurmLauncher', 
'partition': None, 'qos': None, 'comment': None, 'constraint': None, 'exclude': 
None, 'gres': 'gpu:1', 'cpus_per_gpu': None, 'gpus_per_task': None, 
'mem_per_gpu': None, 'mem_per_cpu': None, 'account': None, 'signal_delay_s': 
120, 'max_num_timeout': 0, 'additional_parameters': {}, 'array_parallelism': 
256, 'setup': None}, 'sweeper': {'_target_': 
'hydra_plugins.hydra_smac_sweeper.smac_sweeper.SMACSweeper', 'search_space': 
'${configspace}', 'resume': None, 'optimizer': 'smac', 'budget': 50, 
'budget_variable': 'non_hyperparameters.total_timesteps', 'loading_variable': 
None, 'saving_variable': 'non_hyperparameters.model_save_path', 'smac_kwargs': 
{'intensifier': 'Not-HB', 'max_budget': 2000000, 'job_array_size_limit': 5, 
'max_parallelization': 0.001, 'deterministic': True, 'seeds': [0, 1, 2, 3, 4]}},
'help': {'app_name': '${hydra.job.name}', 'header': '${hydra.help.app_name} is 
powered by Hydra.\n', 'footer': 'Powered by Hydra (https://hydra.cc)\nUse 
--hydra-help to view Hydra specific help\n', 'template': 
'${hydra.help.header}\n== Configuration groups ==\nCompose your configuration 
from those groups (group=option)\n\n$APP_CONFIG_GROUPS\n\n== Config ==\nOverride
anything in the config (foo.bar=value)\n\n$CONFIG\n\n${hydra.help.footer}\n'}, 
'hydra_help': {'template': "Hydra (${hydra.runtime.version})\nSee 
https://hydra.cc for more info.\n\n== Flags ==\n$FLAGS_HELP\n\n== Configuration 
groups ==\nCompose your configuration from those groups (For example, append 
hydra/job_logging=disabled to command line)\n\n$HYDRA_CONFIG_GROUPS\n\nUse 
'--cfg hydra' to Show the Hydra config.\n", 'hydra_help': '???'}, 
'hydra_logging': {'version': 1, 'formatters': {'simple': {'format': 
'[%(asctime)s][HYDRA] %(message)s'}}, 'handlers': {'console': {'class': 
'logging.StreamHandler', 'formatter': 'simple', 'stream': 'ext://sys.stdout'}}, 
'root': {'level': 'INFO', 'handlers': ['console']}, 'loggers': 
{'logging_example': {'level': 'DEBUG'}}, 'disable_existing_loggers': False}, 
'job_logging': {'version': 1, 'formatters': {'simple': {'format': 
'[%(asctime)s][%(name)s][%(levelname)s] - %(message)s'}}, 'handlers': 
{'console': {'class': 'logging.StreamHandler', 'formatter': 'simple', 'stream': 
'ext://sys.stdout'}, 'file': {'class': 'logging.FileHandler', 'formatter': 
'simple', 'filename': '${hydra.runtime.output_dir}/${hydra.job.name}.log'}}, 
'root': {'level': 'INFO', 'handlers': ['console', 'file']}, 
'disable_existing_loggers': False}, 'env': {}, 'mode': <RunMode.MULTIRUN: 2>, 
'searchpath': [], 'callbacks': {}, 'output_subdir': '.hydra', 'overrides': 
{'hydra': ['hydra.mode=MULTIRUN'], 'task': []}, 'job': {'name': 
'blackbox_only_hpo', 'chdir': None, 'override_dirname': '', 'id': '???', 'num': 
'???', 'config_name': 'blackbox_only_hpo', 'env_set': {}, 'env_copy': [], 
'config': {'override_dirname': {'kv_sep': '=', 'item_sep': ',', 'exclude_keys': 
[]}}}, 'runtime': {'version': '1.3.2', 'version_base': '1.1', 'cwd': 
'/mnt/home/lfehring/MasterThesis/architectures-in-rl', 'config_sources': 
[{'path': 'hydra.conf', 'schema': 'pkg', 'provider': 'hydra'}, {'path': 
'/mnt/home/lfehring/MasterThesis/architectures-in-rl/baselines/ant/bb_only_hpo_1
_layer/config', 'schema': 'file', 'provider': 'main'}, {'path': 
'hydra_plugins.hydra_colorlog.conf', 'schema': 'pkg', 'provider': 
'hydra-colorlog'}, {'path': '', 'schema': 'structured', 'provider': 'schema'}], 
'output_dir': '???', 'choices': {'configspace': 'small_space_config', 
'hydra/env': 'default', 'hydra/callbacks': None, 'hydra/job_logging': 'default',
'hydra/hydra_logging': 'default', 'hydra/hydra_help': 'default', 'hydra/help': 
'default', 'hydra/sweeper': 'SMAC', 'hydra/launcher': 'submitit_slurm', 
'hydra/output': 'default'}}, 'verbose': False}, 'batch_size': 64, 'clip_range': 
0.2, 'clip_range_vf': None, 'ent_coef': 0.005, 'gae_lambda': 0.95, 
'learning_rate': 0.000211, 'max_grad_norm': 0.5, 'n_epochs': 10, 'n_steps': 
2048, 'normalize_advantage': True, 'vf_coef': 0.001, 'gamma': 0.99, 'seed': 0, 
'non_hyperparameters': {'trial_number': 0, 'config_id': None, 'experiment_id': 
None, 'environment_id': 'Ant-v4', 'env_seed': 0, 'smac_seed': 0, 
'model_save_path': 'blablabla', 'feature_extractor_architecture': '[64, 64]', 
'pi_dimension': 64, 'vf_dimension': 64, 'observation_keys': ['chars'], 
'max_episode_steps': None, 'parallel_vec_envs': 5, 'n_evaluation_episodes': 10, 
'n_evaluation_rounds': 80, 'total_timesteps': 2000000}, 'PY_EXPERIMENTER': 
{'n_jobs': 1, 'Database': {'provider': 'mysql', 'database': 
'fehring_growing_nn_new_seeded', 'table': {'name': 'ant_bb_net2deeper_baseline',
'keyfields': {'environment_id': {'type': 'VARCHAR(50)'}, 
'feature_extractor_architecture': {'type': 'VARCHAR(50)'}, 'pi_dimension': 
{'type': 'INT'}, 'vf_dimension': {'type': 'INT'}, 'env_seed': {'type': 'INT'}, 
'smac_seed': {'type': 'INT'}, 'model_save_path': {'type': 'VARCHAR(50)'}, 
'observation_keys': {'type': 'VARCHAR(200)'}, 'max_episode_steps': {'type': 
'INT'}, 'parallel_vec_envs': {'type': 'INT'}, 'seed': {'type': 'INT'}, 
'n_evaluation_episodes': {'type': 'INT'}, 'n_evaluation_rounds': {'type': 
'int'}, 'total_timesteps': {'type': 'int'}, 'smac_budget': {'type': 'int'}}, 
'resultfields': {'final_cost': 'FLOAT', 'config': 'TEXT'}}, 'logtables': 
{'configurations': {'environment_id': 'VARCHAR(50)', 'trial_number': 'INT', 
'budget': 'INT', 'hyperparameter_str_identifier': 'VARCHAR(500)', 
'worker_number': 'INT', 'worker_seed': 'INT', 'batch_size': 'INT', 'clip_range':
'VARCHAR(50)', 'clip_range_vf': 'FLOAT', 'ent_coef': 'FLOAT', 'gae_lambda': 
'FLOAT', 'learning_rate': 'FLOAT', 'max_grad_norm': 'FLOAT', 'n_epochs': 'INT', 
'n_steps': 'INT', 'normalize_advantage': 'BOOLEAN', 'vf_coef': 'FLOAT', 'gamma':
'FLOAT', 'feature_extractor_architecture': 'VARCHAR(50)', 'vf_dimension': 'INT',
'pi_dimension': 'INT', 'final_score': 'FLOAT', 'final_std': 'FLOAT'}, 
'training_process': {'worker_id': 'INT', 'trial_number': 'INT', 'budget': 'INT',
'timestep': 'INT', 'mean_cost': 'FLOAT', 'mean_cost_stdev': 'FLOAT', 
'all_costs': 'LONGTEXT', 'actions_per_episode': 'LONGTEXT', 
'rewards_per_episode': 'LONGTEXT'}, 'smac_callbacks': {'trial_number': 'INT', 
'budget': 'INT', 'hyperparameter_str_identifier': 'VARCHAR(500)', 'cost': 
'FLOAT'}, 'final_evaluation_callback': {'trial_number': 'INT', 'budget': 'INT', 
'hyperparameter_str_identifier': 'VARCHAR(500)', 'worker_number': 'INT', 
'final_score': 'FLOAT', 'final_std': 'FLOAT', 'episode_lengths': 'TEXT', 
'average_episode_lengths': 'FLOAT', 'successfull': 'FLOAT', 'dead': 'FLOAT', 
'time_out': 'FLOAT', 'end_states': 'LONGTEXT', 'rewards_per_episode': 
'LONGTEXT', 'actions_per_episode': 'LONGTEXT'}, 'training_losses': 
{'trial_number': 'INT', 'budget': 'INT', 'hyperparameter_str_identifier': 
'VARCHAR(500)', 'worker_number': 'INT', 'n_rollout': 'INT', 'learning_rate': 
'FLOAT', 'entropy_loss': 'FLOAT', 'policy_gradient_loss': 'FLOAT', 'value_loss':
'FLOAT', 'approx_kl': 'FLOAT', 'clip_fraction': 'FLOAT', 'loss': 'FLOAT', 
'explained_variance': 'FLOAT', 'clip_range': 'FLOAT', 'n_updates': 'INT'}}}}, 
'configspace': {'hyperparameters': {'ent_coef': {'type': 'uniform_float', 
'lower': 0.0, 'upper': 0.3}, 'learning_rate': {'log': True, 'type': 
'uniform_float', 'lower': 0.0001, 'upper': 0.01}, 'n_epochs': {'lower': 5, 
'type': 'uniform_int', 'upper': 20}, 'batch_size': {'choices': [32, 64, 128, 
256], 'type': 'categorical'}}}}
Hydra context
HydraContext(
    config_loader=<hydra._internal.config_loader_impl.ConfigLoaderImpl object at
0x7f6cf7ae61f0>,
    callbacks=<hydra._internal.callbacks.Callbacks object at 0x7f6cf59fb880>
)
[2024-08-26 09:28:27,843][HYDRA] Sweep doesn't override default config.
[2024-08-26 09:28:27,881][HYDRA] No values given for keyfield environment_id
[2024-08-26 09:28:27,882][HYDRA] No values given for keyfield feature_extractor_architecture
[2024-08-26 09:28:27,883][HYDRA] No values given for keyfield pi_dimension
[2024-08-26 09:28:27,883][HYDRA] No values given for keyfield vf_dimension
[2024-08-26 09:28:27,883][HYDRA] No values given for keyfield env_seed
[2024-08-26 09:28:27,883][HYDRA] No values given for keyfield smac_seed
[2024-08-26 09:28:27,883][HYDRA] No values given for keyfield model_save_path
[2024-08-26 09:28:27,883][HYDRA] No values given for keyfield observation_keys
[2024-08-26 09:28:27,883][HYDRA] No values given for keyfield max_episode_steps
[2024-08-26 09:28:27,883][HYDRA] No values given for keyfield parallel_vec_envs
[2024-08-26 09:28:27,883][HYDRA] No values given for keyfield seed
[2024-08-26 09:28:27,883][HYDRA] No values given for keyfield n_evaluation_episodes
[2024-08-26 09:28:27,883][HYDRA] No values given for keyfield n_evaluation_rounds
[2024-08-26 09:28:27,883][HYDRA] No values given for keyfield total_timesteps
[2024-08-26 09:28:27,884][HYDRA] No values given for keyfield smac_budget
[2024-08-26 09:28:27,884][HYDRA] Found 15 keyfields
[2024-08-26 09:28:27,884][HYDRA] Found 2 resultfields
[2024-08-26 09:28:27,885][HYDRA] Found 5 logtables
[2024-08-26 09:28:27,885][HYDRA] Found logtable ant_bb_net2deeper_baseline__configurations
[2024-08-26 09:28:27,885][HYDRA] Found logtable ant_bb_net2deeper_baseline__training_process
[2024-08-26 09:28:27,885][HYDRA] Found logtable ant_bb_net2deeper_baseline__smac_callbacks
[2024-08-26 09:28:27,885][HYDRA] Found logtable ant_bb_net2deeper_baseline__final_evaluation_callback
[2024-08-26 09:28:27,885][HYDRA] Found logtable ant_bb_net2deeper_baseline__training_losses
[2024-08-26 09:28:27,885][HYDRA] No custom section defined in config
[2024-08-26 09:28:27,885][HYDRA] No codecarbon section defined in config
[2024-08-26 09:28:27,892][HYDRA] 0 keys loaded from agent
[2024-08-26 09:28:27,892][HYDRA] 0 key(s) loaded
[2024-08-26 09:28:28,315][HYDRA] Connecting to gateway: apollo.ai.uni-hannover.de:22 as user 'fehring'
[2024-08-26 09:28:28,332][HYDRA] Connected (version 2.0, client OpenSSH_8.9p1)
[2024-08-26 09:28:28,457][HYDRA] Authentication (publickey) successful!
[2024-08-26 09:28:28,458][HYDRA] Problem setting SSH Forwarder up: Couldn't open tunnel 127.0.0.1:3306 <> 127.0.0.1:3306 might be in use or destination not reachable
[2024-08-26 09:28:28,458][HYDRA] Failed at creating SSH tunnel. Maybe the tunnel is already active in other process?
[2024-08-26 09:28:28,458][HYDRA] An error occurred while opening tunnels.
[2024-08-26 09:28:28,459][HYDRA] It looks like you didn't call the .stop() before the SSHTunnelForwarder obj was collected by the garbage collector! Running .stop(force=True)
[2024-08-26 09:28:28,459][HYDRA] Closing all open connections...
[2024-08-26 09:28:28,459][HYDRA] Tunnels are not started. Please .start() first!
[2024-08-26 09:28:28,459][HYDRA] Closing ssh transport
[2024-08-26 09:28:28,525][HYDRA] Initialized and connected to database
[2024-08-26 09:28:28,783][HYDRA] Table ant_bb_net2deeper_baseline created.
[2024-08-26 09:28:29,016][HYDRA] Experiment with id 1 successfully added to database for immediate execution.
[2024-08-26 09:28:29,265][HYDRA] Using `n_configs` and ignoring `n_configs_per_hyperparameter`.
[WARNING][target_function_runner.py:74] The argument budget is not set by SMAC: Consider removing it from the target function.
[INFO][abstract_initial_design.py:147] Using 10 initial design configurations and 0 additional configurations.
[INFO][hydra_smac.py:294] Starting SMAC Sweep
[INFO][abstract_intensifier.py:305] Using only one seed for deterministic scenario.
[INFO][submitit_launcher.py:120] Submitit 'slurm' sweep output dir : ./tmp/2024-08-26/09-28-27
[INFO][submitit_launcher.py:134] 	#0 : batch_size=64 ent_coef=0.186169408634305 learning_rate=0.0001640649322125342 n_epochs=8 non_hyperparameters.config_id=1 non_hyperparameters.total_timesteps=2000000 non_hyperparameters.model_save_path=/mnt/home/lfehring/MasterThesis/architectures-in-rl/smac3_output/fehring_growing_nn_new_seeded/ant_bb_net2deeper_baseline/1 non_hyperparameters.experiment_id=1 seed=0 non_hyperparameters.trial_number=0
[INFO][submitit_launcher.py:134] 	#1 : batch_size=64 ent_coef=0.186169408634305 learning_rate=0.0001640649322125342 n_epochs=8 non_hyperparameters.config_id=1 non_hyperparameters.total_timesteps=2000000 non_hyperparameters.model_save_path=/mnt/home/lfehring/MasterThesis/architectures-in-rl/smac3_output/fehring_growing_nn_new_seeded/ant_bb_net2deeper_baseline/1 non_hyperparameters.experiment_id=1 seed=1 non_hyperparameters.trial_number=0
[INFO][submitit_launcher.py:134] 	#2 : batch_size=64 ent_coef=0.186169408634305 learning_rate=0.0001640649322125342 n_epochs=8 non_hyperparameters.config_id=1 non_hyperparameters.total_timesteps=2000000 non_hyperparameters.model_save_path=/mnt/home/lfehring/MasterThesis/architectures-in-rl/smac3_output/fehring_growing_nn_new_seeded/ant_bb_net2deeper_baseline/1 non_hyperparameters.experiment_id=1 seed=2 non_hyperparameters.trial_number=0
[INFO][submitit_launcher.py:134] 	#3 : batch_size=64 ent_coef=0.186169408634305 learning_rate=0.0001640649322125342 n_epochs=8 non_hyperparameters.config_id=1 non_hyperparameters.total_timesteps=2000000 non_hyperparameters.model_save_path=/mnt/home/lfehring/MasterThesis/architectures-in-rl/smac3_output/fehring_growing_nn_new_seeded/ant_bb_net2deeper_baseline/1 non_hyperparameters.experiment_id=1 seed=3 non_hyperparameters.trial_number=0
[INFO][submitit_launcher.py:134] 	#4 : batch_size=64 ent_coef=0.186169408634305 learning_rate=0.0001640649322125342 n_epochs=8 non_hyperparameters.config_id=1 non_hyperparameters.total_timesteps=2000000 non_hyperparameters.model_save_path=/mnt/home/lfehring/MasterThesis/architectures-in-rl/smac3_output/fehring_growing_nn_new_seeded/ant_bb_net2deeper_baseline/1 non_hyperparameters.experiment_id=1 seed=4 non_hyperparameters.trial_number=0
[ERROR][experimenter.py:439] Traceback (most recent call last):
  File "/mnt/home/lfehring/.conda/envs/rl-architecture/lib/python3.8/site-packages/py_experimenter/experimenter.py", line 433, in _execute_experiment
    final_status = experiment_function(keyfield_values, result_processor, self.config.custom_configuration.custom_values)
  File "/mnt/home/lfehring/MasterThesis/architectures-in-rl/hydra_plugins/hydra_smac_sweeper/smac_sweeper_backend.py", line 138, in _sweep
    incumbent = smac.run(True, result_processor.experiment_id)
  File "/mnt/home/lfehring/MasterThesis/architectures-in-rl/hydra_plugins/hydra_smac_sweeper/hydra_smac.py", line 317, in run
    performances, costs = self.run_configs(configs, config_ids, budgets, seeds, experiment_id, trial_numbers)  # Add PyExperimetner ID
  File "/mnt/home/lfehring/MasterThesis/architectures-in-rl/hydra_plugins/hydra_smac_sweeper/hydra_smac.py", line 210, in run_configs
    performances.append(np.mean([res[j * k + k].return_value for k in range(len(self.seeds))]))
  File "/mnt/home/lfehring/MasterThesis/architectures-in-rl/hydra_plugins/hydra_smac_sweeper/hydra_smac.py", line 210, in <listcomp>
    performances.append(np.mean([res[j * k + k].return_value for k in range(len(self.seeds))]))
  File "/mnt/home/lfehring/.conda/envs/rl-architecture/lib/python3.8/site-packages/hydra/core/utils.py", line 260, in return_value
    raise self._return_value
  File "/mnt/home/lfehring/MasterThesis/architectures-in-rl/hydra_plugins/hydra_smac_sweeper/hydra_smac.py", line 201, in run_configs
    res[j].return_value
  File "/mnt/home/lfehring/.conda/envs/rl-architecture/lib/python3.8/site-packages/hydra/core/utils.py", line 260, in return_value
    raise self._return_value
  File "/mnt/home/lfehring/.conda/envs/rl-architecture/lib/python3.8/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
  File "baselines/ant/bb_only_hpo_1_layer/blackbox_only_hpo.py", line 159, in black_box_ppo_configure
    result = experimenter.attach(black_box_ppo_execute, config.non_hyperparameters.experiment_id)
  File "/mnt/home/lfehring/.conda/envs/rl-architecture/lib/python3.8/site-packages/py_experimenter/experimenter.py", line 365, in attach
    return experiment_function(result_processor)
  File "baselines/ant/bb_only_hpo_1_layer/blackbox_only_hpo.py", line 95, in black_box_ppo_execute
    evaluation_callback.log_losses(result_processor, non_hyperparameters["trial_number"], seed, ent_coef, vf_coef)
  File "/mnt/home/lfehring/MasterThesis/architectures-in-rl/utils/stable_baselines_callback.py", line 130, in log_losses
    result_processor.process_logs({"training_losses": {"trial_number": trial_number, "worker_number": worker_number, "n_rollout": n_rollout, **rollout_losses, **kwargs}})
  File "/mnt/home/lfehring/.conda/envs/rl-architecture/lib/python3.8/site-packages/py_experimenter/result_processor.py", line 79, in process_logs
    raise InvalidLogFieldError("Invalid logtable entries. See logs for more information")
py_experimenter.exceptions.InvalidLogFieldError: Invalid logtable entries. See logs for more information

[INFO][experimenter.py:259] Experiment with id 1 successfully executed.
